{"version":3,"file":"app.bba7cd2701d8929e579e.hot-update.js","sources":["webpack:///./public/app/app.ts"],"sourcesContent":["import 'babel-polyfill';\nimport 'file-saver';\nimport 'lodash';\nimport 'jquery';\nimport 'angular';\nimport 'angular-route';\nimport 'angular-sanitize';\nimport 'angular-native-dragdrop';\nimport 'angular-bindonce';\nimport 'react';\nimport 'react-dom';\n\nimport 'vendor/bootstrap/bootstrap';\nimport 'vendor/angular-ui/ui-bootstrap-tpls';\nimport 'vendor/angular-other/angular-strap';\n\nimport $ from 'jquery';\nimport angular from 'angular';\nimport config from 'app/core/config';\nimport _ from 'lodash';\nimport moment from 'moment';\n\n// add move to lodash for backward compatabiltiy\n_.move = function(array, fromIndex, toIndex) {\n  array.splice(toIndex, 0, array.splice(fromIndex, 1)[0]);\n  return array;\n};\n\nimport { coreModule, registerAngularDirectives } from './core/core';\nimport { setupAngularRoutes } from './routes/routes';\n\n// declare var System: any;\n\nexport class GrafanaApp {\n  registerFunctions: any;\n  ngModuleDependencies: any[];\n  preBootModules: any[];\n\n  constructor() {\n    this.preBootModules = [];\n    this.registerFunctions = {};\n    this.ngModuleDependencies = [];\n  }\n\n  useModule(module) {\n    if (this.preBootModules) {\n      this.preBootModules.push(module);\n    } else {\n      _.extend(module, this.registerFunctions);\n    }\n    this.ngModuleDependencies.push(module.name);\n    return module;\n  }\n\n  init() {\n    var app = angular.module('grafana', []);\n\n    moment.locale(config.bootData.user.locale);\n\n    app.config(($locationProvider, $controllerProvider, $compileProvider, $filterProvider, $httpProvider, $provide) => {\n      // pre assing bindings before constructor calls\n      $compileProvider.preAssignBindingsEnabled(true);\n\n      if (config.buildInfo.env !== 'development') {\n        $compileProvider.debugInfoEnabled(false);\n      }\n\n      $httpProvider.useApplyAsync(true);\n\n      this.registerFunctions.controller = $controllerProvider.register;\n      this.registerFunctions.directive = $compileProvider.directive;\n      this.registerFunctions.factory = $provide.factory;\n      this.registerFunctions.service = $provide.service;\n      this.registerFunctions.filter = $filterProvider.register;\n\n      $provide.decorator('$http', [\n        '$delegate',\n        '$templateCache',\n        function($delegate, $templateCache) {\n          var get = $delegate.get;\n          $delegate.get = function(url, config) {\n            if (url.match(/\\.html$/)) {\n              // some template's already exist in the cache\n              if (!$templateCache.get(url)) {\n                url += '?v=' + new Date().getTime();\n              }\n            }\n            return get(url, config);\n          };\n          return $delegate;\n        },\n      ]);\n    });\n\n    this.ngModuleDependencies = [\n      'grafana.core',\n      'ngRoute',\n      'ngSanitize',\n      '$strap.directives',\n      'ang-drag-drop',\n      'grafana',\n      'pasvaz.bindonce',\n      'ui.bootstrap',\n      'ui.bootstrap.tpls',\n      'react',\n    ];\n\n    var module_types = ['controllers', 'directives', 'factories', 'services', 'filters', 'routes'];\n\n    _.each(module_types, type => {\n      var moduleName = 'grafana.' + type;\n      this.useModule(angular.module(moduleName, []));\n    });\n\n    // makes it possible to add dynamic stuff\n    this.useModule(coreModule);\n\n    // register react angular wrappers\n    coreModule.config(setupAngularRoutes);\n    registerAngularDirectives();\n\n    var preBootRequires = [import('app/features/all')];\n\n    Promise.all(preBootRequires)\n      .then(() => {\n        // disable tool tip animation\n        $.fn.tooltip.defaults.animation = false;\n\n        // bootstrap the app\n        angular.bootstrap(document, this.ngModuleDependencies).invoke(() => {\n          _.each(this.preBootModules, module => {\n            _.extend(module, this.registerFunctions);\n          });\n\n          this.preBootModules = null;\n        });\n      })\n      .catch(function(err) {\n        console.log('Application boot failed:', err);\n      });\n  }\n}\n\nexport default new GrafanaApp();\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AAKA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;;AAEA;;;;;A","sourceRoot":""}